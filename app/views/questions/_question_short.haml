-title = h(question.title)
-if question.closed
  -title += " [ZAMKNIĘTE]"

-if !local_assigns[:mini]
  -owner = nil
  - if question.last_target_id.present?
    - last_target_id = question.last_target_id
    - last_target_date = question.last_target_date
    - owner = question.last_target_user
  -else
    - last_target = question
    - last_target_date = question.updated_at
    - owner = question.user unless question.anonymous

  %article{:class => class_for_question(question)}
    .counters
      - votecount = question.votes_average
      .votecount
        .count
          = votecount
        .tail
          - if votecount.abs == 1
            głos
          - elsif votecount.abs % 10 > 1 && votecount.abs % 10 < 5 && votecount.abs % 100 != 10
            głosy
          - else
            głosów
      - answercount = question.answers_count
      - answered = question.answered
      - if answercount
        - if answered
          .answercount-accepted
            .count
              = answercount
            .tail
              - if answercount == 1
                odpowiedź
              - else
                odpowiedzi
        - else
          .answercount
            .count
              = answercount
            .tail
              - if answercount == 1
                odpowiedź
              - else
                odpowiedzi
      - else
        .answercount-none
          .count
            = answercount
          .tail
            odpowiedzi
      - viewcount = question.views_count
      .viewcount
        .count
          = viewcount
        .tail
          - if viewcount == 1
            wyświetlenie
          - elsif viewcount % 10 > 1 && viewcount % 10 < 5 && viewcount % 100 != 10
            wyświetlenia
          - else
            wyświetleń
    .summary
      -cache("question_on_index_#{question.id}_#{I18n.locale}") do
        %h2
          = link_to title, question_path(question), :title => truncate(strip_tags(question.body), :length => 200)

      .user-data
        %span.timeago
          = time_ago_in_words(last_target_date)
        -if owner
          =render :partial => "users/user_data", :locals => {:user => owner}
        -else
          anonim

      .tags
        %ul
          -if question.wiki
            %li{:class => "wiki" }
              wiki
          %li{:class => "tag_gielda"}
            gielda
          %li{:class => "tag_gielda"}
            pytanie
          -question.first_tags.each do |tag|
            %li{:class => "tag_#{h(tag)}"}
              = link_to h(tag), tag_path(:id => tag), :rel => "tag", :title => t("questions.tags.tooltip", :tag => tag)
          -if question.tags.empty? && logged_in? && (current_user.can_modify?(@question) || current_user.can_retag_others_questions_on?(current_group))
            %li
              = link_to t('questions.show.retag'), retag_question_path(question), :id => 'retag', :class => "important"
    .clear

-else
  -cache("mini_question_on_index_#{question.id}_#{I18n.locale}") do
    %article{:class => "#{class_for_question(question)} #{local_assigns[:lite] ? 'lite' : ''}"}

      %h3
        = link_to title, question_path(question)

      .toolbar
        %ul
          %li.answers
            = link_to "#{format_number(question.answers_count)} #{t(:answers, :scope => "activerecord.attributes.question")}"
